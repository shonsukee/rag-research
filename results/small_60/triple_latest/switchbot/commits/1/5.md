# LLM Response
```scala
class SwitchBotApiClientImpl @Inject() (
  okHttpClient: OkHttpClient,
  switchBotConfiguration: SwitchBotConfiguration,
  cacheClient: CacheClient[SwitchBotDevicesDataModel],
  clock: Clock
)(implicit
  executionContext: ExecutionContext
) extends SwitchBotApiClient {
  import SwitchBotApiClientImpl.*

  private val logger = LoggerFactory.getLogger(this.getClass)

  private def requestWithAuthorization(path: String): Request = {
    // generate the required headers: t, nonce, sign
    val t       = clock.millis().toString
    val nonce   = java.util.UUID.randomUUID().toString
    val alg     = "HmacSHA256"
    val keySpec = new javax.crypto.spec.SecretKeySpec(
      switchBotConfiguration.secretKey.getBytes("UTF-8"),
      alg
    )
    val mac      = javax.crypto.Mac.getInstance(alg)
    mac.init(keySpec)
    val payload   = switchBotConfiguration.oauthToken + t + nonce
    val signature = javax.xml.bind.DatatypeConverter
                      .printHexBinary(mac.doFinal(payload.getBytes("UTF-8")))
                      .toLowerCase

    new Request.Builder()
      .url(switchBotConfiguration.switchBotEndpoint.resolve(path).toURL)
      .addHeader("Authorization", switchBotConfiguration.oauthToken)
      .addHeader("sign", signature)
      .addHeader("t", t)
      .addHeader("nonce", nonce)
      .build()
  }

  private val getAllDevicesRequest: Request =
    requestWithAuthorization("/v1.0/devices")

  private def getMeterInfoRequest(deviceId: String): Request =
    requestWithAuthorization(s"/v1.0/devices/$deviceId/status")

  def getMeterInfo: Future[Seq[SwitchBotMeterInfo]] =
    for {
      allDevices <- getAllDevices
      meterIds = allDevices.collect { case (SwitchBotDeviceType.MeterPlus, deviceId) =>
        deviceId
      }
      meterJsonStrings <- Future.sequence(
        meterIds.toSeq.map(id =>
          Future(
            blocking(
              okHttpClient
                .newCall(getMeterInfoRequest(id))
                .execute()
                .body()
                .string()
            )
          )
        )
      )
      result <- Future.sequence(
        meterJsonStrings.map(meterJsonString =>
          Json
            .fromJson[SwitchBotMeterInfo](
              Json.parse(meterJsonString)
            )
            .fold(
              error =>
                Future.failed(
                  new IllegalArgumentException(
                    s"""JSON parse error!
                       |  error: ${error.mkString(",")}
                       |  response: $meterJsonString
                       |""".stripMargin
                  )
                ),
              Future.successful
            )
        )
      )
    } yield result
}
```

# User Query
## Instruction
You are a software engineer specializing in REST APIs.
Please follow the guidelines below to make the necessary modifications.

### Modification Procedure
1. Analyze the deprecated specifications based on `## Deprecated specification`.
2. Based on the analysis in step 1., identify code snippets that follow deprecated specifications within the source code in `## Input Code`.
3. Analyze the latest specifications based on `### Technical Specifications for latest natural language` and `### Technical Specifications for latest code`.
4. Modify the code snippets identified in step 2. to follow the latest specifications analyzed in step 3., while paying attention to the points listed in `### Attention` below.

### Attention
There may be multiple code snippets following deprecated specifications within `## Input Code`.
Only refer to the information in `## Latest specification` when making modifications.
Do not perform refactoring or add comments; only modify the parts of the code that follow deprecated specifications to conform to the latest specifications.
Copy the source code from `## Input Code` before making modifications.
Delete all parts only according to the deprecated specification and modify the code to conform to the latest specification.
Only modify the parts of the code that follow deprecated specifications.
If no deprecated specification is found in the source code of the `## Input Code`, compare the source code with the latest specification to identify any differences. If modifications are required, modify the source code according to the latest specification.
Make sure to modify all code that follows deprecated specifications.
After modifications, ensure that all code following deprecated specifications has been replaced with code that conforms to the latest specifications.
If multiple deprecated specifications are present within `## Input Code`, confirm that all are unified under the latest specifications.

## Deprecated specification
```
【Context No.1】
15 | set the TV channel to switch to
| command | volumeAdd | default | volume up
| command | volumeSub | default | volume down
| command | channelAdd | default | next channel
| command | channelSub | default | previous channel
DVD, Speaker | command | setMute | default | mute/unmute
| command | FastForward | default | fast forward
| command | Rewind | default | rewind
| command | Next | default | next track
| command | Previous | default | last track
| command | Pause | default | pause
| command | Play | default | play/resume
| command | Stop | default | stop
Speaker | command | volumeAdd | default | volume up
| command | volumeSub | default | volume down
Fan | command | swing | default | swing
| command | timer | default | set timer
| command | lowSpeed | default | set fan speed to low
| command | middleSpeed | default | set fan speed to medium
| command | highSpeed | default | set fan speed to high
Light | command | brightnessUp | default | brightness up
| command | brightnessDown | default | brightness down
> Note: Most of the devices support `turnOn` or `turnOff`, which are case-
> sensitive. For infrared remote devices, when you have created customized
> buttons, you must set `commandType` to `customize`, otherwise the command
> will not work. `command` needs to be set to the name of the customized
> button.
#### Path parameters
Name | Type | Required | Description
---|---|---|---
deviceId | String | Yes | device ID
#### Request body parameters
Name | Type | Required | Description
---|---|---|---
command | String | Yes | the name of the command
parameter | String | No | some commands require parameters, such as `SetChannel`
commandType | String | No | for customized buttons, this needs to be set to `customzie`
#### Response
The response is basically a JSON object, which contains the following
properties,
Key Name | Value Type
---|---
statusCode | Integer
message | String
body | Object
#### Errors
Error code/message | Description
---|---
{"message": "Unauthorized"} | Http 401 Error. User permission is denied due to invalid token.

【Context No.2】
"deviceMac": DEVICE_MAC_ADDR,
            "powerState": "ON",
            "brightness": 10,
            "color":"255:245:235",
            "colorTemperature":3500,
            "timeOfSample": 123456789
        }
    }
#### LED Strip Light
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
powerState | String | the current power state of the device, "ON" or "OFF"
brightness | Integer | the brightness value, range from 1 to 100
color | String | the color value, in the format of RGB value, "255:255:255"
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoStrip",
            "deviceMac": DEVICE_MAC_ADDR,
            "powerState": "ON",
            "brightness": 10,
            "color": "255:245:235",
            "timeOfSample": 123456789
        }
    }
#### Plug Mini (US)
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
powerState | String | the current power state of the device, "ON" or "OFF"
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoPlugUS",
            "deviceMac": DEVICE_MAC_ADDR,
            "powerState": "ON",

【Context No.3】
User permission is denied due to invalid token.
190 | Device internal error due to device states not synchronized with server
#### Sample
##### Execute a scene
Request

    POST https://api.switch-bot.com/v1.0/scenes/T02-202009221414-48924101/execute
Response

    {
        "statusCode": 100,
        "body": {},
        "message": "success"
    }
## Webhook
### Configure webhook
#### Description
Configure the url that all the webhook events will be sent to
#### Request

    POST https://api.switch-bot.com/v1.0/webhook/setupWebhook
##### Request body parameters
Key Name | Value Type | Description
---|---|---
action | String | the type of actions
url | String | the url where all the events are sent to
deviceList | String | the list of device ids, currently only supports "ALL"
Head

    {
        "Content-type":"application/json",
        "Authorization":your_token // enter your API token
    }
Body

    {
        "action":"setupWebhook",
        "url":url1, // enter your url
        "deviceList":"ALL"
    }
#### Response
Sample

    {
        "statusCode": 100,
        "body": {},
        "message": ""
    }
### Get webhook configuration
#### Description
Get the current configuration info of the webhook
#### Request

    POST https://api.switch-bot.com/v1.0/webhook/queryWebhook
##### Request body parameters
Key Name | Value Type | Description
---|---|---
action | String | the type of actions, currently supports "queryUrl", "queryDetails"
url | String | the url where all the events are sent to.

【Context No.4】
### Get scene list

    GET /v1.0/scenes
#### Description
Get a list of manual scenes created by the current user.
#### Response
The response is basically a JSON object, which contains the following
properties,
Key Name | Value Type
---|---
statusCode | Integer
message | String
body | Object
The body object contains a list of objects, which has the following
properties,
Key | Type | Description
---|---|---
sceneId | String | a scene's ID
sceneName | String | a scene's name
#### Errors
Error code/message | Description
---|---
{"message": "Unauthorized"} | Http 401 Error. User permission is denied due to invalid token.
190 | Device internal error due to device states not synchronized with server
#### Sample
##### Get all scenes
Request

    GET https://api.switch-bot.com/v1.0/scenes
Response

    {
        "statusCode": 100,
        "body": [
            {
                "sceneId": "T02-20200804130110",
                "sceneName": "Close Office Devices"
            },
            {
                "sceneId": "T02-202009221414-48924101",
                "sceneName": "Set Office AC to 25"
            },
            {
                "sceneId": "T02-202011051830-39363561",
                "sceneName": "Set Bedroom to 24"
            },
            {
                "sceneId": "T02-202011051831-82928991",
                "sceneName": "Turn off home devices"
            },
            {
                "sceneId": "T02-202011062059-26364981",
                "sceneName": "Set Bedroom to 26 degree"
            }
        ],
        "message": "success"
    }
### Execute manual scenes

    POST /v1.0/scenes/{sceneId}/execute
#### Description
Sends a request to execute a manual scene.
#### Path parameters
Name | Type | Required | Description
---|---|---|---
sceneId | String | Yes | scene ID
The response is basically a JSON object, which contains the following
properties,
Key Name | Value Type
---|---
statusCode | Integer
message | String
body | Object
#### Errors
Error code/message | Description
---|---
{"message": "Unauthorized"} | Http 401 Error.

【Context No.5】
range from 1 to 100
color | String | Color Bulb/Strip Light | the color value, RGB "255:255:255"
colorTemperature | Integer | Color Bulb | the color temperature value, range from 2700 to 6500
lackWater | Boolean | Humidifier | determines if the water tank is empty or not
voltage | Integer | Plug Mini | Current voltage of the device (Unit: V)
weight | Integer | Plug Mini | the power consumption of the device for the day (Unit: W/min)
electricityOfDay | Integer | Plug Mini | How long the device has been used for the day (Unit: min)
electricCurrent | Integer | Plug Mini | current of the device (Unit: A) at the moment
lockState | String | Lock | determines if the lock is locked or not
doorState | String | Lock | determines if the door is closed or not
workingStatus | String | Robot Vacuum Cleaner S1/ S1 Plus | the working status of the device, e.g. Cleaning, Paused
onlineStatus | String | Robot Vacuum Cleaner S1/ S1 Plus | determines if the device is online or offline
battery | Integer | Robot Vacuum Cleaner S1/ S1 Plus | the battery level
The reponses may contain the following codes and message,
Status Code | Body Content | Message | Description
---|---|---|---
100 | Device list object | success | Returns an object that contains two device lists
n/a | n/a | Unauthorized | Http 401 Error. User permission is denied due to invalid token.

【Context No.6】
"deviceMac": DEVICE_MAC_ADDR,
            "detectionState": "NOT_DETECTED",
            "doorMode":"OUT_DOOR",
            "brightness": "dim",
            "openState": "open",
            "timeOfSample": 123456789
        }
    }
#### Meter
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
temperature | Float | the current temperature reading
scale | String | the current temperature unit being used
humidity | Integer | the current humidity reading in percentage
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoMeter",
            "deviceMac": DEVICE_MAC_ADDR,
            "temperature": 22.5,
            "scale": "CELSIUS",
            "humidity": 31,
            "timeOfSample": 123456789
        }
    }
#### Meter Plus
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
temperature | Float | the current temperature reading
scale | String | the current temperature unit being used
humidity | Integer | the current humidity reading in percentage
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoMeter",
            "deviceMac": DEVICE_MAC_ADDR,
            "temperature": 22.5,
            "scale": "CELSIUS",
            "humidity": 31,

【Context No.7】
you need to specify the url when using queryDetails
##### queryUrl
Head

    {
        "Content-type":"application/json",
        "Authorization":your_token // enter your API token
    }
Body

    {
        "action": "queryUrl"
    }
##### queryDetails
Head

    {
        "Content-type":"application/json",
        "Authorization":your_token // enter your API token
    }
Body

    {
        "action": "queryDetails",
        "urls":[url1] // get infos of a url
    }
#### Response
##### queryUrl

    {
        "statusCode": 100,
        "body": {
            "urls": [url1] // the target url
        },
        "message": ""
    }
##### queryDetails

    {
        "statusCode": 100,
        "body": [
            {
                "url":url1,
                "createTime":123456,
                "lastUpdateTime":123456,
                "deviceList": "ALL",
                "enable":true
            }
        ],
        "message": ""
    }
### Update webhook configuration
#### Description
Update the configuration of the webhook
#### Request

    POST https://api.switch-bot.com/v1.0/webhook/queryWebhook
##### Request body parameters
Key Name | Value Type | Description
---|---|---
action | String | the type of actions
config | Object | the configuration details you want to update. you can change the current url or enable/disable the webhook.

【Context No.8】
determines if a Curtain is the master device or not when paired with or grouped with another Curtain
openDirection | String | only available for Curtain devices. the opening direction of a Curtain
The infraredRemoteList array contains a list of objects with the following
key-value attributes,
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
remoteType | String | device type
hubDeviceId | String | remote device's parent Hub ID
The response may contain the following codes and messages,
Status Code | Body Content | Message | Description
---|---|---|---
100 | Device list object | success | Returns an object that contains two device lists
n/a | n/a | Unauthorized | Http 401 Error. User permission is denied due to invalid token.
190 | n/a | System error | Device internal error due to device states not synchronized with server
#### Sample
##### Get all devices
Request

    GET https://api.switch-bot.com/v1.0/devices
Response

    {
        "statusCode": 100,
        "body": {
            "deviceList": [
                {
                    "deviceId": "500291B269BE",
                    "deviceName": "Living Room Humidifier",
                    "deviceType": "Humidifier",
                    "enableCloudService": true,
                    "hubDeviceId": "000000000000"
                }
            ],
            "infraredRemoteList": [
                {
                    "deviceId": "02-202008110034-13",
                    "deviceName": "Living Room TV",
                    "remoteType": "TV",
                    "hubDeviceId": "FA7310762361"
                }
            ]
        },
        "message": "success"
    }
### Get device status

    GET /v1.0/devices/{deviceId}/status
#### Description
Get the status of a physical device that has been added to the current user's
account.
Physical devices refer to the following SwitchBot products,

【Context No.9】
1,60` | power: off/on,
fanMode: 1/2,
fanSpeed: 1/2/3/4,
shakeRange: 0~120
fanMode: 1 (Standard), 2 (Natural)
Color Bulb | command | turnOn | default | set to ON state
Color Bulb | command | turnOff | default | set to OFF state
Color Bulb | command | toggle | default | toggle state
Color Bulb | command | setBrightness | `{1-100}` | set brightness
Color Bulb | command | setColor | `"{0-255}:{0-255}:{0-255}"` | set RGB color value
Color Bulb | command | setColorTemperature | `{2700-6500}` | set color temperature
Strip Light | command | turnOn | default | set to ON state
Strip Light | command | turnOff | default | set to OFF state
Strip Light | command | toggle | default | toggle state
Strip Light | command | setBrightness | `{1-100}` | set brightness
Strip Light | command | setColor | `"{0-255}:{0-255}:{0-255}"` | set RGB color value
Plug Mini (US/JP) | command | turnOn | default | set to ON state
Plug Mini (US/JP) | command | turnOff | default | set to OFF state
Plug Mini (US/JP) | command | toggle | default | toggle state
Robot Vacuum Cleaner S1 | command | start | default | start vacuuming
Robot Vacuum Cleaner S1 | command | stop | default | stop vacuuming
Robot Vacuum Cleaner S1 | command | dock | default | return to charging dock
Robot Vacuum Cleaner S1 | command | PowLevel | `{0-3}` | set suction power level: 0 (Quiet), 1 (Standard), 2 (Strong), 3 (MAX)
Robot Vacuum Cleaner S1 Plus | command | start | default | start vacuuming
Robot Vacuum Cleaner S1 Plus | command | stop | default | stop vacuuming
Robot Vacuum Cleaner S1 Plus | command | dock | default | return to charging dock
Robot Vacuum Cleaner S1 Plus | command | PowLevel | `{0-3}` | set suction power level: 0 (Quiet), 1 (Standard), 2 (Strong),

【Context No.10】
User permission is denied due to invalid token.
151 | device type error
152 | device not found
160 | command is not supported
161 | device offline
171 | hub device is offline
190 | Device internal error due to device states not synchronized with server. Or command format is invalid.
#### Sample
##### Bot example
Turn a Bot on
Request

    POST https://api.switch-bot.com/v1.0/devices/210/commands

    {
        "command": "turnOn",
        "parameter": "default",
        "commandType": "command"
    }
Response

    {
        "statusCode": 100,
        "body": {},
        "message": "success"
    }
Set the color value of a Color Bulb Request

    POST https://api.switch-bot.com/v1.0/devices/84F70353A411/commands

    {
        "command": "setColor",
        "parameter": "122:80:20", // yellow
        "commandType": "command"
    }
Response

    {
        "statusCode": 100,
        "body": {},
        "message": "success"
    }
##### Infrared remote device example
Set an Air Conditioner
Request

    POST https://api.switch-bot.com/v1.0/devices/02-202007201626-70/commands

    {
        "command": "setAll",
        "parameter": "26,1,3,on",
        "commandType": "command"
    }
Response

    {
        "statusCode": 100,
        "body": {},
        "message": "success"
    }
Trigger a customized button
Request

    POST https://api.switch-bot.com/v1.0/devices/02-202007201626-10/commands

    {
        "command": "ボタン", // the name of the customized button
        "parameter": "default",
        "commandType": "customize"
    }
Response

    {
        "statusCode": 100,
        "body": {},
        "message": "success"
    }
## Scenes
The scenes API is used to access the smart scenes created by a user and to
execute manual scenes.
### Get scene list

    GET /v1.0/scenes
#### Description
Get a list of manual scenes created by the current user.

【Context No.11】
"DETECTED" stands for motion is detected; "NOT_DETECTED" stands for motion has not been detected for some time
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoPresence",
            "deviceMac": DEVICE_MAC_ADDR,
            "detectionState": "NOT_DETECTED",
            "timeOfSample": 123456789
        }
    }
#### Contact Sensor
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
detectionState | String | the motion state of the device, "DETECTED" stands for motion is detected; "NOT_DETECTED" stands for motion has not been detected for some time
doorMode | String | when the enter or exit mode gets triggered, "IN_DOOR" or "OUT_DOOR" is returned
brightness | String | the level of brightness, can be "bright" or "dim"
openState | String | the state of the contact sensor, can be "open" or "close" or "timeOutNotClose"
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoContact",
            "deviceMac": DEVICE_MAC_ADDR,
            "detectionState": "NOT_DETECTED",
            "doorMode":"OUT_DOOR",
            "brightness": "dim",
            "openState": "open",

【Context No.12】
"eventVersion": "1",
        "context": {
            "deviceType": "WoCamera",
            "deviceMac": DEVICE_MAC_ADDR,
            "detectionState": "DETECTED",
            "timeOfSample": 123456789
        }
    }
#### Pan/Tilt Cam
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
detectionState | String | the detection state of the device, "DETECTED" stands for motion is detected
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoPanTiltCam",
            "deviceMac": DEVICE_MAC_ADDR,
            "detectionState": "DETECTED",
            "timeOfSample": 123456789
        }
    }
#### Color Bulb
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
powerState | String | the current power state of the device, "ON" or "OFF"
brightness | Integer | the brightness value, range from 1 to 100
color | String | the color value, in the format of RGB value, "255:255:255"
colorTemperature | Integer | the color temperature value, range from 2700 to 6500
timeOfSample | Long | the time stamp when the event is sent

    {
        "eventType": "changeReport",
        "eventVersion": "1",
        "context": {
            "deviceType": "WoBulb",
            "deviceMac": DEVICE_MAC_ADDR,
            "powerState": "ON",
            "brightness": 10,
            "color":"255:245:235",
            "colorTemperature":3500,

【Context No.13】
User permission is denied due to invalid token.
190 | n/a | System error | Device internal error due to device states not synchronized with server
#### Sample
##### SwitchBot Meter example
Request the status of a SwitchBot Thermometer and Hygrometer
Request

    GET https://api.switch-bot.com/v1.0/devices/C271111EC0AB/status
Response

    {
        "statusCode": 100,
        "body": {
            "deviceId": "C271111EC0AB",
            "deviceType": "Meter",
            "hubDeviceId": "FA7310762361",
            "humidity": 52,
            "temperature": 26.1
        },
        "message": "success"
    }
##### SwitchBot Curtain example
Request the status of a SwitchBot Curtain
Request

    GET https://api.switch-bot.com/v1.0/devices/E2F6032048AB/status
Response

    {
        "statusCode": 100,
        "body": {
            "deviceId": "E2F6032048AB",
            "deviceType": "Curtain",
            "hubDeviceId": "FA7310762361",
            "calibrate": true,
            "group": false,
            "moving": false,
            "slidePosition": 0
        },
        "message": "success"
    }
### Send device control commands

    POST /v1.0/devices/{deviceId}/commands
#### Description
Send control commands to physical devices and virtual infrared remote devices.
#### Command set for physical devices
The table below describes all the available commands for physical devices,
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Bot | command | turnOff | default | set to OFF state
Bot | command | turnOn | default | set to ON state
Bot | command | press | default | trigger press
Plug | command | turnOn | default | set to ON state
Plug | command | turnOff | default | set to OFF state
Curtain | command | setPosition | index0,mode0,position0
e.g.
```

## Input Code
```
class SwitchBotApiClientImpl @Inject() (
  okHttpClient: OkHttpClient,
  switchBotConfiguration: SwitchBotConfiguration,
  cacheClient: CacheClient[SwitchBotDevicesDataModel],
  clock: Clock
)(implicit
  executionContext: ExecutionContext
) extends SwitchBotApiClient {
  import SwitchBotApiClientImpl.*

  private val logger = LoggerFactory.getLogger(this.getClass)

  private def requestWithAuthorization(path: String): Request =
    new Request.Builder()
      .url(switchBotConfiguration.switchBotEndpoint.resolve(path).toURL)
      .addHeader(
        "Authorization",
        switchBotConfiguration.oauthToken
      )
      .build()

  private val getAllDevicesRequest: Request =
    requestWithAuthorization("/v1.0/devices")

  private def getMeterInfoRequest(deviceId: String): Request =
    requestWithAuthorization(s"/v1.0/devices/$deviceId/status")

  def getMeterInfo: Future[Seq[SwitchBotMeterInfo]] =
    for {
      allDevices <- getAllDevices
      meterIds = allDevices.collect { case (SwitchBotDeviceType.MeterPlus, deviceId) =>
        deviceId
      }
      meterJsonStrings <- Future.sequence(
        meterIds.toSeq.map(id =>
          Future(
            blocking(
              okHttpClient
                .newCall(getMeterInfoRequest(id))
                .execute()
                .body()
                .string()
            )
          )
        )
      )
      result <- Future.sequence(
        meterJsonStrings.map(meterJsonString =>
          Json
            .fromJson[SwitchBotMeterInfo](
              Json.parse(meterJsonString)
            )
            .fold(
              error =>
                Future.failed(
                  new IllegalArgumentException(
                    s"""JSON parse error!
                       |  error: ${error.mkString(",")}
                       |  response: $meterJsonString
                       |""".stripMargin
                  )
                ),
              Future.successful
            )
        )
      )
    } yield result
}
```

## Technical Specifications for latest natural language
```
【Context No.1】
15 | set the TV channel to switch to
| command | volumeAdd | default | volume up
| command | volumeSub | default | volume down
| command | channelAdd | default | next channel
| command | channelSub | default | previous channel
DVD, Speaker | command | setMute | default | mute/unmute
| command | FastForward | default | fast forward
| command | Rewind | default | rewind
| command | Next | default | next track
| command | Previous | default | last track
| command | Pause | default | pause
| command | Play | default | play/resume
| command | Stop | default | stop
Speaker | command | volumeAdd | default | volume up
| command | volumeSub | default | volume down
Fan | command | swing | default | swing
| command | timer | default | set timer
| command | lowSpeed | default | set fan speed to low
| command | middleSpeed | default | set fan speed to medium
| command | highSpeed | default | set fan speed to high
Light | command | brightnessUp | default | brightness up
| command | brightnessDown | default | brightness down
> Note: Most of the devices support `turnOn` or `turnOff`, which are case-
> sensitive. For infrared remote devices, when you have created customized
> buttons, you must set `commandType` to `customize`, otherwise the command
> will not work. `command` needs to be set to the name of the customized
> button.
#### Path parameters
Name | Type | Required | Description
---|---|---|---
deviceId | String | Yes | device ID
#### Request body parameters
Name | Type | Required | Description
---|---|---|---
command | String | Yes | the name of the command
parameter | String | No | some commands require parameters, such as `SetChannel`
commandType | String | No | for customized buttons, this needs to be set to `customzie`
#### Response
lig The response is basically a JSON object, which contains the following
properties,
Key Name | Value Type
---|---
statusCode | Integer
message | String
body | Object
#### Errors
Error code/message | Description
---|---
{"message": "Unauthorized"} | Http 401 Error. User permission is denied due to invalid token.

【Context No.2】
the time stamp when the event is sent
#### Ceiling Light
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
powerState | String | attributes of the context object. ON/OFF state
brightness | Integer | attributes of the context object. the brightness value, range from 1 to 100
colorTemperature | Integer | attributes of the context object. the color temperature value, range from 2700 to 6500
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### Ceiling Light Pro
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
powerState | String | attributes of the context object. ON/OFF state
brightness | Integer | attributes of the context object. the brightness value, range from 1 to 100
colorTemperature | Integer | attributes of the context object. the color temperature value, range from 2700 to 6500
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### Keypad
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
eventName | String | attributes of the context object. the name of the command being sent
commandId | String | attributes of the context object. the command id
result | String | attributes of the context object. the result of the command. _success_ , _failed_ , or _timeout_.

【Context No.3】
_Curtain_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID
curtainDevicesIds | Array | a list of Curtain device IDs such that the Curtain devices are being paired or grouped
calibrate | Boolean | determines if the open position and the close position of a device have been properly calibrated or not
group | Boolean | determines if a Curtain is paired with or grouped with another Curtain or not
master | Boolean | determines if a Curtain is the master device or not when paired with or grouped with another Curtain
openDirection | String | the opening direction of a Curtain
##### Curtain 3
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Curtain3_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID
curtainDevicesIds | Array | a list of Curtain device IDs such that the Curtain devices are being paired or grouped
calibrate | Boolean | determines if the open position and the close position of a device have been properly calibrated or not
group | Boolean | determines if a Curtain is paired with or grouped with another Curtain or not
master | Boolean | determines if a Curtain is the master device or not when paired with or grouped with another Curtain
openDirection | String | the opening direction of a Curtain
##### Hub/Hub Plus/Hub Mini/Hub 2/Hub 3
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Hub_ , _Hub Plus_ , _Hub Mini_ , _Hub 2_ or _Hub 3_.
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID. _000000000000_ when the device itself is a Hub or it is connected through Wi-Fi.
##### Meter
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type.

【Context No.4】
range from 1 to 100
color | String | the color value, in the format of RGB value, "255:255:255"
colorTemperature | Integer | the color temperature value, range from 2700 to 6500
timeOfSample | Long | the time stamp when the event is sent
#### LED Strip Light
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
powerState | String | the current power state of the device, "ON" or "OFF"
brightness | Integer | the brightness value, range from 1 to 100
color | String | the color value, in the format of RGB value, "255:255:255"
timeOfSample | Long | the time stamp when the event is sent
#### Plug Mini (US)
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
powerState | String | the current power state of the device, "ON" or "OFF"
timeOfSample | Long | the time stamp when the event is sent
#### Plug Mini (JP)
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
powerState | String | the current power state of the device, "ON" or "OFF"
timeOfSample | Long | the time stamp when the event is sent
#### Robot Vacuum Cleaner S1
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object.

【Context No.5】
_Curtain3_
hubDeviceId | String | device's parent Hub ID
calibrate | Boolean | determines if the open position and the close position of a device have been properly calibrated or not
group | Boolean | determines if a Curtain is paired with or grouped with another Curtain or not
moving | Boolean | determines if a Curtain is moving or not
battery | Integer | Four-segment battery level division,`<10%, shown as 5;10%~20%, shown as 15;20%~60%, shown as 40;≥60%, shown as 80`
version | String | the current firmware version, e.g. V4.2
slidePosition | String | the percentage of the distance between the calibrated open position and closed position that Curtain has traversed
##### Meter
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceType | String | device type. _Meter_
hubDeviceId | String | device's parent Hub ID
temperature | Float | temperature in celsius
version | String | the current firmware version, e.g. V4.2
battery | Integer | Four-segment battery level division,`<10%, shown as 10;10%~20%, shown as 20;20%~60%, shown as 60;≥60%, shown as 100`
humidity | Integer | humidity percentage
##### Meter Plus
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceType | String | device type. _MeterPlus_
hubDeviceId | String | device's parent Hub ID
battery | Integer | Four-segment battery level division,`<10%, shown as 10;10%~20%, shown as 20;20%~60%, shown as 60;≥60%, shown as 100`
version | String | the current firmware version, e.g. V4.2
temperature | Float | temperature in celsius
humidity | Integer | humidity percentage
##### Outdoor Meter
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceType | String | device type.

【Context No.6】
the command id
result | String | attributes of the context object. the result of the command. _success_ , _failed_ , or _timeout_. timeout duration is 1 minute
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
##### Create a passcode
##### Delete a passcode
#### Keypad Touch
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
eventName | String | attributes of the context object. the name of the command being sent
commandId | String | attributes of the context object. the command id
result | String | attributes of the context object. the result of the command. _success_ , _failed_ , or _timeout_. timeout duration is 1 minute
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
##### Create a passcode
##### Delete a passcode
#### Hub 2
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
temperature | Float | the current temperature reading
humidity | Integer | the current humidity reading in percentage
lightLevel | Integer | the level of illuminance of the ambience light, 1~20
scale | String | the current temperature unit being used
timeOfSample | Long | attributes of the context object.

【Context No.7】
the command id
result | String | attributes of the context object. the result of the command. _success_ , _failed_ , or _timeout_. timeout duration is 1 minute
timeOfSample | Long | the time stamp when the event is sent
##### Create a passcode
##### Delete a passcode
#### Lock Ultra
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
lockState | String | the state of the device, "LOCKED" stands for the motor is rotated to locking position; "UNLOCKED" stands for the motor is rotated to unlocking position; "JAMMED" stands for the motor is jammed while rotating
battery | Integer | the battery level
timeOfSample | Long | the time stamp when the event is sent
#### Strip Light 3
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
powerState | String | ON/OFF state
colorTemperature | Integer | attributes of the context object. the color temperature value, range from 2700 to 6500
color | String | the color value, in the format of RGB value, "255:255:255"
timeOfSample | Long | the time stamp when the event is sent
#### K20+ Pro
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object. the working status of the device.

【Context No.8】
_Keypad_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID
lockDeviceId | String | MAC address of the Lock that the current device is paired with
keyList | Object | a list of passcodes
`keyList` maintains a list of passcodes,
Key | Value Type | Description
---|---|---
id | Integer | passcode ID
name | String | name of the passcode
type | String | type of the passcode. _permanent_ , a permanent passcode. _timeLimit_ , a temporary passcode. _disposable_ , a one-time passcode. _urgent_ , an emergency passcode.
password | String | the passcode string encrypted with the developer secret key using the aes-128-cbc algorithm
iv | String | an arbitrary number used for the encryption
status | String | validity of the passcode. _normal_ , the passcode is valid. _expired_ , the passcode is invalid.
createTime | Long | the time when the passcode is generated
##### Keypad Touch
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Keypad Touch_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID
lockDeviceId | String | MAC address of the Lock that the current device is paired with
keyList | Object | a list of passcodes
`keyList` maintains a list of passcodes,
Key | Value Type | Description
---|---|---
id | Integer | passcode ID
name | String | name of the passcode
type | String | type of the passcode. _permanent_ , a permanent passcode. _timeLimit_ , a temporary passcode. _disposable_ , a one-time passcode. _urgent_ , an emergency passcode.
password | String | the passcode string encrypted with the developer secret key using the aes-128-cbc algorithm
iv | String | an arbitrary number used for the encryption
status | String | validity of the passcode. _normal_ , the passcode is valid. _expired_ , the passcode is invalid.

【Context No.9】
This state is only valid for Switch Mode, where "on" stands for on and "off" stands for off. It will return "on" or "off" in Press Mode or Customize Mode, but the returned value can be neglected.
timeOfSample | Long | the time stamp when the event is sent
#### Curtain
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
calibrate | Boolean | determines if the open position and the close position of a device have been properly calibrated or not
group | Boolean | determines if a Curtain is paired with or grouped with another Curtain or not
slidePosition | Integer | the percentage of the distance between the calibrated open position and closed position that Curtain has traversed
battery | Integer | the battery level of a Curtain
timeOfSample | Long | the time stamp when the event is sent
#### Curtain 3
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
calibrate | Boolean | determines if the open position and the close position of a device have been properly calibrated or not
group | Boolean | determines if a Curtain is paired with or grouped with another Curtain or not
slidePosition | Integer | the percentage of the distance between the calibrated open position and closed position that Curtain has traversed
battery | Integer | the battery level of a Curtain
timeOfSample | Long | the time stamp when the event is sent
#### Motion Sensor
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
detectionState | String | the motion state of the device, "DETECTED" stands for motion is detected; "NOT_DETECTED" stands for motion has not been detected for some time
battery | Integer | the current battery level,

【Context No.10】
`action_str`, the cleaning mode, _sweep_ or _mop_.
`fanLevel`, the vacuum level, `1-4`.
`times`, the number of cycles, `1-2639999`, in theory.
K20+ Pro | command | pause | default | pause cleaning
K20+ Pro | command | dock | default | return to charging dock
K20+ Pro | command | setVolume | `{0-100}` | set the robot volume
K20+ Pro | command | changeParam | {"fanLevel": fan_level_int, "waterLevel": water_level_int, "times": clean_cycle_int} | change clean parameters. `fan_level_int`, the vacuum level, `1-4`; `water_level_int`, the mop moisture level, `1-2`; `times`, the number of cycles, `1-2639999`, in theory.
##### K10+ Pro Combo
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Robot Vacuum Cleaner K10+ Pro Combo | command | startClean | {"action": action_str, "param": {"fanLevel": fan_level_int, "times": clean_cycle_int}} | start cleaning.
`action_str`, the cleaning mode, _sweep_ or _mop_.
`fanLevel`, the vacuum level, `1-4`.
`times`, the number of cycles, `1-2639999`, in theory.
Robot Vacuum Cleaner K10+ Pro Combo | command | pause | default | pause cleaning
Robot Vacuum Cleaner K10+ Pro Combo | command | dock | default | return to charging dock
Robot Vacuum Cleaner K10+ Pro Combo | command | setVolume | `{0-100}` | set the robot volume
Robot Vacuum Cleaner K10+ Pro Combo | command | changeParam | {"fanLevel": fan_level_int, "times": clean_cycle_int} | change clean parameters. `fan_level_int`, the vacuum level, `1-4`; `times`, the number of cycles, `1-2639999`, in theory.

【Context No.11】
the brightness value, range from 1 to 100
colorTemperature | Integer | attributes of the context object. the color temperature value, range from 2700 to 6500
color | String | the color value, in the format of RGB value, "255:255:255"
timeOfSample | Long | the time stamp when the event is sent
#### Lock Lite
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
lockState | String | determines if locked or not
battery | Integer | the battery level
timeOfSample | Long | the time stamp when the event is sent
#### Video Doorbell
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
battery | Integer | the battery level
detectionState | String | the motion state of the device, "DETECTED" stands for motion is detected; "NOT_DETECTED" stands for motion has not been detected for some time
timeOfSample | Long | the time stamp when the event is sent
press | Boolean | the Doorbell button was pressed
#### Keypad Vision
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
eventName | String | attributes of the context object. the name of the command being sent
commandId | String | attributes of the context object. the command id
result | String | attributes of the context object. the result of the command. _success_ , _failed_ , or _timeout_.

【Context No.12】
User permission is denied due to invalid token.
151 | device type error
152 | device not found
160 | command is not supported
161 | device offline
171 | hub device is offline
190 | Device internal error due to device states not synchronized with server. Or command format is invalid.
#### Sample
##### Floor Cleaning Robot S10 example
Clean with vacuum mode
Request
Response
Change the cleaning settings
Request
Response
##### Keypad example
Create a temporary passcode
Request
Response
##### Bot example
Turn a Bot on
Request
Response
Set the color value of a Color Bulb Request
Response
##### Infrared remote device example
Set an Air Conditioner
Request
Response
Trigger a customized button
Request
Response
## Scenes
The scenes API is used to access the smart scenes created by a user and to
execute manual scenes.
### Get scene list
#### Description
Get a list of manual scenes created by the current user.
#### Response
The response is basically a JSON object, which contains the following
properties,
Key Name | Value Type
---|---
statusCode | Integer
message | String
body | Object
The body object contains a list of objects, which has the following
properties,
Key | Type | Description
---|---|---
sceneId | String | a scene's ID
sceneName | String | a scene's name
#### Errors
Error code/message | Description
---|---
{"message": "Unauthorized"} | Http 401 Error. User permission is denied due to invalid token.
190 | Device internal error due to device states not synchronized with server
#### Sample
##### Get all scenes
Request
Response
### Execute manual scenes
#### Description
Sends a request to execute a manual scene.
#### Path parameters
Name | Type | Required | Description
---|---|---|---
sceneId | String | Yes | scene ID
The response is basically a JSON object, which contains the following
properties,
Key Name | Value Type
---|---
statusCode | Integer
message | String
body | Object
#### Errors
Error code/message | Description
---|---
{"message": "Unauthorized"} | Http 401 Error. User permission is denied due to invalid token.

【Context No.13】
User permission is denied due to invalid token.
190 | Device internal error due to device states not synchronized with server
#### Sample
##### Execute a scene
Request
Response
## Webhook
### Configure webhook
#### Description
Configure the url that all the webhook events will be sent to
#### Request
##### Request body parameters
Key Name | Value Type | Description
---|---|---
action | String | the type of actions
url | String | the url where all the events are sent to
deviceList | String | the list of device ids, currently only supports "ALL"
Head
Body
#### Response
Sample
### Get webhook configuration
#### Description
Get the current configuration info of the webhook
#### Request
##### Request body parameters
Key Name | Value Type | Description
---|---|---
action | String | the type of actions, currently supports "queryUrl", "queryDetails"
url | String | the url where all the events are sent to. you need to specify the url when using queryDetails
##### queryUrl
Head
Body
##### queryDetails
Head
Body
#### Response
##### queryUrl
##### queryDetails
### Update webhook configuration
#### Description
Update the configuration of the webhook
#### Request
##### Request body parameters
Key Name | Value Type | Description
---|---|---
action | String | the type of actions
config | Object | the configuration details you want to update. you can change the current url or enable/disable the webhook. refer to the example below
Head
Body
#### Response
### Delete webhook
#### Description
Delete the configuration of the webhook
#### Request
##### Request body parameters
Key Name | Value Type | Description
---|---|---
action | String | the type of actions
url | String | the url where all the events are sent to
Head
Body
#### Response
### Receive events from webhook
When an event gets triggered, SwitchBot server will send a `POST` request to
the url you have configured. Refer to the table below for a list of products
that support webhook.

【Context No.14】
which contains the following
properties,
Key Name | Value Type
---|---
statusCode | Integer
message | String
body | Object
The reponses may contain the following codes and message,
Status Code | Body Content | Message | Description
---|---|---|---
100 | Device list object | success | Returns an object that contains two device lists
n/a | n/a | Unauthorized | Http 401 Error. User permission is denied due to invalid token.
190 | n/a | System error | Device internal error due to device states not synchronized with server
The `body` object contains the following properties,
##### Bot
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceType | String | device type. _Bot_
power | String | ON/OFF state
battery | Integer | Four-segment battery level division,`<10%, shown as 9;10%~20%, shown as 19;20%~60%, shown as 59;≥60%, shown as 100`
version | String | the current firmware version, e.g. V6.3
deviceMode | String | _pressMode_ , _switchMode_ , or _customizeMode_
hubDeviceId | String | device's parent Hub ID
##### Curtain
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceType | String | device type. _Curtain_
hubDeviceId | String | device's parent Hub ID
calibrate | Boolean | determines if the open position and the close position of a device have been properly calibrated or not
group | Boolean | determines if a Curtain is paired with or grouped with another Curtain or not
moving | Boolean | determines if a Curtain is moving or not
battery | Integer | Four-segment battery level division,`<10%, shown as 5;10%~20%, shown as 15;20%~60%, shown as 40;≥60%, shown as 80`
version | String | the current firmware version, e.g. V4.2
slidePosition | String | the percentage of the distance between the calibrated open position and closed position that Curtain has traversed
##### Curtain 3
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceType | String | device type.

【Context No.15】
the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object. the working status of the device. _StandBy_ , _Clearing_ , _Paused_ , _GotoChargeBase_ , _Charging_ , _ChargeDone_ , _Dormant_ , _InTrouble_ , _InRemoteControl_ , or _InDustCollecting_
onlineStatus | String | attributes of the context object. the connection status of the device. _online_ or _offline_
battery | Integer | attributes of the context object. the battery level, range from 0 to 100
taskType | String | attributes of the context object. the current task in progress. _standBy_ , _explore_ , _cleanAll_ , _cleanArea_ , _cleanRoom_ , _backToCharge_ , _collectDust_ , _remoteControl_ , _cleanWithExplorer_
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### Floor Cleaning Robot S10
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object. the working status of the device. _StandBy_ , _Clearing_ , _Paused_ , _GotoChargeBase_ , _Charging_ , _ChargeDone_ , _Dormant_ , _InTrouble_ , _InRemoteControl_ , or _InDustCollecting_
onlineStatus | String | attributes of the context object. the connection status of the device. _online_ or _offline_
battery | Integer | attributes of the context object. the battery level, `0-100`
waterBaseBattery | Integer | the current battery level `0-100`
taskType | String | the current task in progress.

【Context No.16】
_Keypad Vision_
hubDeviceId | String | device's parent Hub ID
#### Sample
##### SwitchBot Meter example
Request the status of a SwitchBot Thermometer and Hygrometer
Request
Response
##### SwitchBot Curtain example
Request the status of a SwitchBot Curtain
Request
Response
### Send device control commands
#### Description
Send control commands to physical devices and virtual infrared remote devices.
#### Command set for physical devices
##### Bot
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Bot | command | turnOff | default | set to OFF state
Bot | command | turnOn | default | set to ON state
Bot | command | press | default | trigger press
##### Curtain
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Curtain | command | setPosition | index0,mode0,position0
e.g. `0,ff,80` | mode: 0 (Performance Mode), 1 (Silent Mode), ff (default mode)
position: 0~100 (0 means open, 100 means closed)
Curtain | command | turnOff | default | equivalent to set position to 100
Curtain | command | turnOn | default | equivalent to set position to 0
Curtain | command | pause | default | set to PAUSE state
##### Curtain 3
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Curtain 3 | command | setPosition | index0,mode0,position0
e.g.

【Context No.17】
the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object. the working status of the device. _StandBy_ , _Clearing_ , _Paused_ , _GotoChargeBase_ , _Charging_ , _ChargeDone_ , _Dormant_ , _InTrouble_ , _InRemoteControl_ , or _InDustCollecting_
onlineStatus | String | attributes of the context object. the connection status of the device. _online_ or _offline_
battery | Integer | attributes of the context object. the battery level, range from 0 to 100
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### Mini Robot Vacuum K10+ Pro
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object. the working status of the device. _StandBy_ , _Clearing_ , _Paused_ , _GotoChargeBase_ , _Charging_ , _ChargeDone_ , _Dormant_ , _InTrouble_ , _InRemoteControl_ , or _InDustCollecting_
onlineStatus | String | attributes of the context object. the connection status of the device. _online_ or _offline_
battery | Integer | attributes of the context object. the battery level, range from 0 to 100
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### K10+ Pro Combo
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object.

【Context No.18】
`0-100`
timeOfSample | Long | the time stamp when the event is sent
#### Meter Plus
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
temperature | Float | the current temperature reading
scale | String | the current temperature unit being used
humidity | Integer | the current humidity reading in percentage
battery | Integer | the current battery level, `0-100`
timeOfSample | Long | the time stamp when the event is sent
#### Outdoor Meter
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
temperature | Float | the current temperature reading
scale | String | the current temperature unit being used
humidity | Integer | the current humidity reading in percentage
battery | Integer | the current battery level, `0-100`
timeOfSample | Long | the time stamp when the event is sent
#### Meter Pro
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
temperature | Float | the current temperature reading
scale | String | the current temperature unit being used
humidity | Integer | the current humidity reading in percentage
battery | Integer | the current battery level,

【Context No.19】
429 | Too Many Requests | The client has exceeded the number of requests allowed for a given time window.
500 | Internal Server Error | An unexpected error on the SmartThings servers has occurred. These errors should be rare.
## Devices
The devices API is used to access the properties and states of SwitchBot
devices and to send control commands to those devices.
### Get device list
#### Description
Get a list of devices, which include physical devices and virtual infrared
remote devices that have been added to the current user's account.
> Note: For devices that communicate via BLE, please enable Cloud Services on
> SwitchBot app first.

【Context No.20】
For BLE-based devices such as Bot and Curtain
  3. You MUST first add a SwitchBot Hub such as Hub 2, Hub Mini with Matter Enabled, or Hub Mini
  4. Then enable Cloud Services on the Settings page in order to make use of the web API!
## API Usage
### Host Domain
### Sending a Request
The following request types are supported,
  * GET
  * PUT
  * POST
  * DELETE
#### Content-Type
For `POST` requests, use `application/json; charset=utf8` as the `Content-
Type`
#### Request limit
The amount of API calls per day is limited to **10000** times. Going over that
limit will return "Unauthorized."
### Request Header
The following parameters need to be included into the header,
Parameter | Type | Location | Required | Description
---|---|---|---|---
Authorization | String | header | Yes | Open Token acquired
sign | String | header | Yes | A signature generated from the token and secret key using a specific algorithm.
t | Long | header | Yes | A 13 digit timestamp (standard time).
nonce | Long | header | Yes | A random UUID generated by developers themselves to blend into the string to sign.
### Standard HTTP Error Codes
The following table lists the most common HTTP error response,
Code | Name | Description
---|---|---
400 | Bad Request | The client has issued an invalid request. This is commonly used to specify validation errors in a request payload.
401 | Unauthorized | Authorization for the API is required, but the request has not been authenticated.
403 | Forbidden | The request has been authenticated but does not have appropriate permissions, or a requested resource is not found.
404 | Not Found | Specifies the requested path does not exist.
406 | Not Acceptable | The client has requested a MIME type via the Accept header for a value not supported by the server.
415 | Unsupported Media Type | The client has defined a contentType header that is not supported by the server.
422 | Unprocessable Entity | The client has made a valid request, but the server cannot process it. This is often used for APIs for which certain limits have been exceeded.
429 | Too Many Requests | The client has exceeded the number of requests allowed for a given time window.
500 | Internal Server Error | An unexpected error on the SmartThings servers has occurred. These errors should be rare.

【Context No.21】
Door Opener | command | turnOn | default | set to ON state
Garage Door Opener | command | turnOff | default | set to OFF state
##### Floor Lamp
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Floor Lamp | command | turnOn | default | set to ON state
Floor Lamp | command | turnOff | default | set to OFF state
Floor Lamp | command | toggle | default | toggle state
Floor Lamp | command | setBrightness | `{0-100}` | set brightness
Floor Lamp | command | setColor | `"{0-255}:{0-255}:{0-255}"` | set RGB color value
Floor Lamp | command | setColorTemperature | `{2700-6500}` | set color temperature
##### Strip Light 3
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Strip Light 3 | command | turnOn | default | set to ON state
Strip Light 3 | command | turnOff | default | set to OFF state
Strip Light 3 | command | toggle | default | toggle state
Strip Light 3 | command | setBrightness | `{1-100}` | set brightness
Strip Light 3 | command | setColor | `"{0-255}:{0-255}:{0-255}"` | set RGB color value
Strip Light 3 | command | setColorTemperature | `{2700-6500}` | set color temperature
##### Lock Lite
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Lock Lite | command | lock | default | rotate to locked position
Lock Lite | command | unlock | default | rotate to unlocked position
##### Lock Ultra
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Lock Ultra | command | lock | default | rotate to locked position
Lock Ultra | command | unlock | default | rotate to unlocked position
Lock Ultra | command | deadbolt | default | disengage deadbolt or latch
##### Video Doorbell
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Video Doorbell | command | enableMotionDetection | default | Set to enabled state
Video Doorbell | command | disableMotionDetection | default | Set to disabled state
##### Keypad Vision
The control commands for this product work

【Context No.22】
1 (Standard), 2 (Strong), 3 (MAX)
##### Robot Vacuum Cleaner S1 Plus
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Robot Vacuum Cleaner S1 Plus | command | start | default | start vacuuming
Robot Vacuum Cleaner S1 Plus | command | stop | default | stop vacuuming
Robot Vacuum Cleaner S1 Plus | command | dock | default | return to charging dock
Robot Vacuum Cleaner S1 Plus | command | PowLevel | `{0-3}` | set suction power level: 0 (Quiet), 1 (Standard), 2 (Strong), 3 (MAX)
##### Mini Robot Vacuum K10+
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
K10+ | command | start | default | start vacuuming
K10+ | command | stop | default | stop vacuuming
K10+ | command | dock | default | return to charging dock
K10+ | command | PowLevel | `{0-3}` | set suction power level: 0 (Quiet), 1 (Standard), 2 (Strong), 3 (MAX)
##### Mini Robot Vacuum K10+ Pro
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
K10+ Pro | command | start | default | start vacuuming
K10+ Pro | command | stop | default | stop vacuuming
K10+ Pro | command | dock | default | return to charging dock
K10+ Pro | command | PowLevel | `{0-3}` | set suction power level: 0 (Quiet), 1 (Standard), 2 (Strong), 3 (MAX)
##### K20+ Pro
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
K20+ Pro | command | startClean | {"action": action_str, "param": {"fanLevel": fan_level_int, "times": clean_cycle_int}} | start cleaning.
`action_str`, the cleaning mode, _sweep_ or _mop_.
`fanLevel`, the vacuum level, `1-4`.
`times`, the number of cycles, `1-2639999`, in theory.

【Context No.23】
* Request body parameters
        * queryUrl
        * queryDetails
      * Response
        * queryUrl
        * queryDetails
    * Update webhook configuration
      * Description
      * Request
        * Request body parameters
      * Response
    * Delete webhook
      * Description
      * Request
        * Request body parameters
      * Response
    * Receive events from webhook
      * Bot
      * Curtain
      * Curtain 3
      * Motion Sensor
      * Contact Sensor
      * Water Leak Detector
      * Meter
      * Meter Plus
      * Outdoor Meter
      * Meter Pro
      * Meter Pro CO2 Monitor
      * Lock
      * Lock Pro
      * Indoor Cam
      * Pan/Tilt Cam
      * Color Bulb
      * LED Strip Light
      * Plug Mini (US)
      * Plug Mini (JP)
      * Robot Vacuum Cleaner S1
      * Robot Vacuum Cleaner S1 Plus
      * Mini Robot Vacuum K10+
      * Mini Robot Vacuum K10+ Pro
      * K10+ Pro Combo
      * Multitasking Household Robot K20+ Pro
      * Floor Cleaning Robot S10
      * Floor Cleaning Robot S20
      * Ceiling Light
      * Ceiling Light Pro
      * Keypad
        * Create a passcode
        * Delete a passcode
      * Keypad Touch

【Context No.24】
the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object. the working status of the device. _StandBy_ , _Clearing_ , _Paused_ , _GotoChargeBase_ , _Charging_ , _ChargeDone_ , _Dormant_ , _InTrouble_ , _InRemoteControl_ , or _InDustCollecting_
onlineStatus | String | attributes of the context object. the connection status of the device. _online_ or _offline_
battery | Integer | attributes of the context object. the battery level, range from 0 to 100
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### Robot Vacuum Cleaner S1 Plus
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object. the working status of the device. _StandBy_ , _Clearing_ , _Paused_ , _GotoChargeBase_ , _Charging_ , _ChargeDone_ , _Dormant_ , _InTrouble_ , _InRemoteControl_ , or _InDustCollecting_
onlineStatus | String | attributes of the context object. the connection status of the device. _online_ or _offline_
battery | Integer | attributes of the context object. the battery level, range from 0 to 100
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### Mini Robot Vacuum K10+
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | attributes of the context object. the type of the device
deviceMac | String | attributes of the context object. the MAC address of the device
workingStatus | String | attributes of the context object.

【Context No.25】
"DETECTED" stands for motion is detected; "NOT_DETECTED" stands for motion has not been detected for some time
battery | Integer | the current battery level, `0-100`
timeOfSample | Long | the time stamp when the event is sent
#### Contact Sensor
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
detectionState | String | the motion state of the device, "DETECTED" stands for motion is detected; "NOT_DETECTED" stands for motion has not been detected for some time
doorMode | String | when the enter or exit mode gets triggered, "IN_DOOR" or "OUT_DOOR" is returned
brightness | String | the level of brightness, can be "bright" or "dim"
openState | String | the state of the contact sensor, can be "open" or "close" or "timeOutNotClose"
battery | Integer | the current battery level, `0-100`
timeOfSample | Long | the time stamp when the event is sent
#### Water Leak Detector
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
detectionState | Integer | `0`, dry. `1`, leak detected
battery | Integer | the current battery level, `0-100`
timeOfSample | Long | the time stamp when the event is sent
#### Meter
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
temperature | Float | the current temperature reading
scale | String | the current temperature unit being used
humidity | Integer | the current humidity reading in percentage
battery | Integer | the current battery level,

【Context No.26】
a 10-digit timestamp.
endTime | Long | set the time the passcode becomes expired, mandatory for one-time passcode and temporary passcode. a 10-digit timestamp.
The following table describes the parameter object for `deleteKey`,
Key Name | Value Type | Description
---|---|---
id | String | the id of the passcode
##### Color Bulb
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Color Bulb | command | turnOn | default | set to ON state
Color Bulb | command | turnOff | default | set to OFF state
Color Bulb | command | toggle | default | toggle state
Color Bulb | command | setBrightness | `{1-100}` | set brightness
Color Bulb | command | setColor | `"{0-255}:{0-255}:{0-255}"` | set RGB color value
Color Bulb | command | setColorTemperature | `{2700-6500}` | set color temperature
##### Strip Light
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Strip Light | command | turnOn | default | set to ON state
Strip Light | command | turnOff | default | set to OFF state
Strip Light | command | toggle | default | toggle state
Strip Light | command | setBrightness | `{1-100}` | set brightness
Strip Light | command | setColor | `"{0-255}:{0-255}:{0-255}"` | set RGB color value
##### Robot Vacuum Cleaner S1
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Robot Vacuum Cleaner S1 | command | start | default | start vacuuming
Robot Vacuum Cleaner S1 | command | stop | default | stop vacuuming
Robot Vacuum Cleaner S1 | command | dock | default | return to charging dock
Robot Vacuum Cleaner S1 | command | PowLevel | `{0-3}` | set suction power level: 0 (Quiet), 1 (Standard), 2 (Strong),

【Context No.27】
##### Ceiling Light Pro
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Ceiling Light Pro_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID. _000000000000_ when the device itself is a Hub or it is connected through Wi-Fi.
##### Plug Mini (US)
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Plug Mini (US)_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID. _000000000000_ when the device itself is a Hub or it is connected through Wi-Fi.
##### Plug Mini (JP)
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Plug Mini (JP)_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID. _000000000000_ when the device itself is a Hub or it is connected through Wi-Fi.
##### Plug
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Plug_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID. _000000000000_ when the device itself is a Hub or it is connected through Wi-Fi.
##### Strip Light
Key | Value Type | Description
---|---|---
deviceId | String | device ID
deviceName | String | device name
deviceType | String | device type. _Strip Light_
enableCloudService | Boolean | determines if Cloud Service is enabled or not for the current device
hubDeviceId | String | device's parent Hub ID. _000000000000_ when the device itself is a Hub or it is connected through Wi-Fi.

【Context No.28】
Due to security concerns, the passcodes are stored locally. This
mechanism dramatically prolongs the time needed to successfully create a
passcode and get the correct result through the Web API. Hence, the actual
results of the following commands are returned from the SwitchBot server
asynchronously and are delivered through a webhook.
You need to configure a webhook to receive the correct result. Refer to this
product's webhook definition.
deviceType | commandType | Command | command parameter | Description
---|---|---|---|---
Keypad | command | createKey | { "name": passcode _name_str, "type": passcode_type_str, "password": passcode_str, "startTime": valid_from_long, "endTime": valid_to_long } | create a new passcode
Keypad | command | deleteKey | { "id": passcode_id_int } | delete an existing passcode
The following table describes the parameter object for `createKey`,
Key Name | Value Type | Description
---|---|---
name | String | a unique name for the passcode. duplicates under the same device are not allowed.
type | String | type of the passcode. _permanent_ , a permanent passcode. _timeLimit_ , a temporary passcode. _disposable_ , a one-time passcode. _urgent_ , an emergency passcode.
password | String | a 6 to 12-digit passcode in plain text
startTime | Long | set the time the passcode becomes valid from, mandatory for one-time passcode and temporary passcode. a 10-digit timestamp.
endTime | Long | set the time the passcode becomes expired, mandatory for one-time passcode and temporary passcode. a 10-digit timestamp.
The following table describes the parameter object for `deleteKey`,
Key Name | Value Type | Description
---|---|---
id | String | the id of the passcode
##### Keypad Touch
The control commands for this product work differently than the other
products. Due to security concerns, the passcodes are stored locally. This
mechanism dramatically prolongs the time needed to successfully create a
passcode and get the correct result through the Web API. Hence, the actual
results of the following commands are returned from the SwitchBot server
asynchronously and are delivered through a webhook.
You need to configure a webhook to receive the correct result.

【Context No.29】
the time stamp when the event is sent
#### Hub 3
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
detectionState | String | the motion state of the device, "DETECTED" stands for motion is detected; "NOT_DETECTED" stands for motion has not been detected for some time
deviceMac | String | attributes of the context object. the MAC address of the device
deviceType | String | attributes of the context object. the type of the device
humidity | Integer | the current humidity reading in percentage
lightLevel | Integer | the level of illuminance of the ambience light, 1~10
scale | String | the current temperature unit being used
temperature | Float | the current temperature reading
timeOfSample | Long | attributes of the context object. the time stamp when the event is sent
#### Battery Circulator Fan
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
mode | String | fan mode. direct mode: _direct_ ; natural mode: "natural"; sleep mode: "sleep"; ultra quiet mode: "baby"
version | String | the current firmware version, e.g. V4.2
battery | Integer | the current battery level
powerState | String | ON/OFF state
nightStatus | Integer | set nightlight status. turn off: _off_ ; mode 1: _1_ ; mode 2: _2_
oscillation | String | set horizontal oscillation. turn on: _on_ ; turn off: _off_
verticalOscillation | String | set vertical oscillation. turn on: _on_ ; turn off: _off_
chargingStatus | String | battery charge status. _charging_ or _uncharged_
fanSpeed | Integer | fan speed.

【Context No.30】
turn on: _on_ ; turn off: _off_
chargingStatus | String | battery charge status. _charging_ or _uncharged_
fanSpeed | Integer | fan speed. 1~100
timeOfSample | Long | the time stamp when the event is sent
#### Circulator Fan
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
mode | String | fan mode. direct mode: _direct_ ; natural mode: "natural"; sleep mode: "sleep"; ultra quiet mode: "baby"
version | String | the current firmware version, e.g. V4.2
powerState | String | ON/OFF state
nightStatus | Integer | set nightlight status. turn off: _off_ ; mode 1: _1_ ; mode 2: _2_
oscillation | String | set horizontal oscillation. turn on: _on_ ; turn off: _off_
verticalOscillation | String | set vertical oscillation. turn on: _on_ ; turn off: _off_
fanSpeed | Integer | fan speed. 1~100
timeOfSample | Long | the time stamp when the event is sent
#### Evaporative Humidifier
Key Name | Value Type | Description
---|---|---
eventType | String | the type of events
eventVersion | String | the current event version
context | Object | the detail info of the event
deviceType | String | the type of the device
deviceMac | String | the MAC address of the device
power | String | the power state of the device
mode | Integer | the current mode.
```

## Technical Specifications for latest code
```
【Context No.1】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoStrip",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",
        "brightness": 10,
        "color": "255:245:235",
        "timeOfSample": 123456789
    }
}

【Context No.2】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoContact",
        "deviceMac": DEVICE_MAC_ADDR,
        "detectionState": "NOT_DETECTED",
        "doorMode":"OUT_DOOR",
        "brightness": "dim",
        "openState": "open",
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.3】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoKeypadVision",
        "deviceMac": DEVICE_MAC_ADDR,
        "eventName": "createKey",
        "commandId": "CMD-1663558451952-01",
        "result": "success",
        "timeOfSample": 123456789
    }
}

【Context No.4】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoKeypadTouch",
        "deviceMac": DEVICE_MAC_ADDR,
        "eventName": "createKey",
        "commandId": "CMD-1663558451952-01",
        "result": "success",
        "timeOfSample": 123456789
    }
}

【Context No.5】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Strip Light 3",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",//"ON"or"OFF"
        "brightness": 10,
        "color": "255:255:0",
        "colorTemperature": 3500,
        "timeOfSample": 123456789
    }
}

【Context No.6】
{
   "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Floor Lamp",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",
        "brightness": 10,
        "color": "255:255:0",
        "colorTemperature": 3500,
        "timeOfSample": 123456789
    }
}

【Context No.7】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoKeypad",
        "deviceMac": DEVICE_MAC_ADDR,
        "eventName": "createKey",
        "commandId": "CMD-1663558451952-01",
        "result": "success",
        "timeOfSample": 123456789
    }
}

【Context No.8】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoCurtain",
        "deviceMac": DEVICE_MAC_ADDR,
        "calibrate":false,
        "group":false,
        "slidePosition":50, //0~100
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.9】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoCeiling",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",
        "brightness": 10,
        "colorTemperature": 3500,
        "timeOfSample": 123456789
    }
}

【Context No.10】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoCurtain3",
        "deviceMac": DEVICE_MAC_ADDR,
        "calibrate":false,
        "group":false,
        "slidePosition":50, //0~100
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.11】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoPresence",
        "deviceMac": DEVICE_MAC_ADDR,
        "detectionState": "NOT_DETECTED",
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.12】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Garage Door Opener",
        "deviceMac": "FFFFFFFFFFF",
        "doorStatus": 1, 
    }
}

【Context No.13】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Water Detector",
        "deviceMac": DEVICE_MAC_ADDR,
        "detectionState": 0,
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.14】
{
    "command": "setColor",
    "parameter": "122:80:20", // yellow
    "commandType": "command"
}

【Context No.15】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoPlugUS",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",
        "timeOfSample": 123456789
    }
}

【Context No.16】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoPlugJP",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",
        "timeOfSample": 123456789
    }
}

【Context No.17】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoBulb",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",
        "brightness": 10,
        "color":"255:245:235",
        "colorTemperature":3500,
        "timeOfSample": 123456789
    }
}

【Context No.18】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoCeilingPro",
        "deviceMac": DEVICE_MAC_ADDR,
        "powerState": "ON",
        "brightness": 10,
        "colorTemperature": 3500,
        "timeOfSample": 123456789
    }
}

【Context No.19】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoIOSensor",
        "deviceMac": DEVICE_MAC_ADDR,
        "temperature": 22.5,
        "scale": "CELSIUS",
        "humidity": 31,
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.20】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Robot Vacuum Cleaner S10",
        "deviceMac": DEVICE_MAC_ADDR,
        "workingStatus"："StandBy",
        "onlineStatus": "online",
        "battery": 100,// 0-100
        "waterBaseBattery": 100,
        "taskType": "explore",
        "timeOfSample": 123456789
    }
}

【Context No.21】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoFan2",
        "deviceMac": DEVICE_MAC_ADDR,
        "mode": "direct",
        "version": "V3.1",
        "battery": 22,
        "powerState": "ON",
        "nightStatus": "off",
        "oscillation": "on",
        "verticalOscillation": "on",
        "chargingStatus": "charging",
        "fanSpeed": 3,
        "timeOfSample": 123456789
    }
}

【Context No.22】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoKeypadTouch",
        "deviceMac": DEVICE_MAC_ADDR,
        "eventName": "deleteKey ",
        "commandId": "CMD-1663558451952-01",
        "result": "success",
        "timeOfSample": 123456789
    }
}

【Context No.23】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoPanTiltCam",
        "deviceMac": DEVICE_MAC_ADDR,
        "detectionState": "DETECTED",
        "timeOfSample": 123456789
    }
}

【Context No.24】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "MeterPro",
        "deviceMac": DEVICE_MAC_ADDR,
        "temperature": 22.5,
        "scale": "CELSIUS",
        "humidity": 31,
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.25】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoKeypadVision",
        "deviceMac": DEVICE_MAC_ADDR,
        "eventName": "deleteKey ",
        "commandId": "CMD-1663558451952-01",
        "result": "success",
        "timeOfSample": 123456789
    }
}

【Context No.26】
{
  "eventType": "changeReport",
  "eventVersion": "1",
  "context": {
    "detectionState": "DETECTED",
    "deviceMac": "B0E9FE582974",
    "deviceType": "Hub 3",
    "humidity": 45,
    "lightLevel": 10,
    "scale": "CELSIUS",
    "temperature": 30.3,
    "timeOfSample": 1742807095763
  }
}

【Context No.27】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Robot Vacuum Cleaner K10+ Pro Combo",
        "deviceMac": DEVICE_MAC_ADDR,
        "workingStatus"："StandBy",
        "onlineStatus": "online",
        "battery": 100,
        "taskType": "explore",
        "timeOfSample": 123456789
    }
}

【Context No.28】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoRollerShade",
        "deviceMac": DEVICE_MAC_ADDR,
        "calibrate":false,
        "slidePosition":50, //0~100
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.29】
{
    "statusCode": 100,
    "body": {
        "commandId": "CMD166444044923602"
    },
    "message": "success"
}

【Context No.30】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoCamera",
        "deviceMac": DEVICE_MAC_ADDR,
        "detectionState": "DETECTED",
        "timeOfSample": 123456789
    }
}

【Context No.31】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoHand",
        "deviceMac": DEVICE_MAC_ADDR,
        "power": "on",//"on"or"off"
        "battery": 10,
        "deviceMode": "pressMode",//pressMode,switchMode,customizeMode
        "timeOfSample": 123456789
    }
}

【Context No.32】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoKeypad",
        "deviceMac": DEVICE_MAC_ADDR,
        "eventName": "deleteKey ",
        "commandId": "CMD-1663558451952-01",
        "result": "success",
        "timeOfSample": 123456789
    }
}

【Context No.33】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Robot Vacuum Cleaner s20",
        "deviceMac": DEVICE_MAC_ADDR,
        "workingStatus"："StandBy",
        "onlineStatus": "online",
        "battery": 100,// 0-100
        "waterBaseBattery": 100,
        "taskType": "explore",
        "timeOfSample": 123456789
    }
}

【Context No.34】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoHub2",
        "deviceMac": DEVICE_MAC_ADDR,
        "temperature":13,
        "humidity":18,
        "lightLevel": 19,
        "scale": "CELSIUS",
        "timeOfSample": 123456789
    }
}

【Context No.35】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoMeter",
        "deviceMac": DEVICE_MAC_ADDR,
        "temperature": 22.5,
        "scale": "CELSIUS",
        "humidity": 31,
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.36】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoFan2",
        "deviceMac": DEVICE_MAC_ADDR,
        "mode": "direct",
        "version": "V3.1",
        "powerState": "ON",
        "nightStatus": "off",
        "oscillation": "on",
        "verticalOscillation": "on",
        "fanSpeed": 3,
        "timeOfSample": 123456789
    }
}

【Context No.37】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "MeterPro(CO2)",
        "deviceMac": DEVICE_MAC_ADDR,
        "temperature": 22.5,
        "scale": "CELSIUS",
        "humidity": 31,
        "CO2": 1203,
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.38】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoSweeperPlus",
        "deviceMac": DEVICE_MAC_ADDR,
        "workingStatus"："StandBy",
        "onlineStatus": "online",
        "battery": 100,
        "timeOfSample": 123456789
    }
}

【Context No.39】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoSweeper",
        "deviceMac": DEVICE_MAC_ADDR,
        "workingStatus"："StandBy",
        "onlineStatus": "online",
        "battery": 100,
        "timeOfSample": 123456789
    }
}

【Context No.40】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoSweeperMiniPro",
        "deviceMac": DEVICE_MAC_ADDR,
        "workingStatus"："StandBy",
        "onlineStatus": "online",
        "battery": 100,
        "timeOfSample": 123456789
    }
}

【Context No.41】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoSweeperMini",
        "deviceMac": DEVICE_MAC_ADDR,
        "workingStatus"："StandBy",
        "onlineStatus": "online",
        "battery": 100,
        "timeOfSample": 123456789
    }
}

【Context No.42】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Video Doorbell",
        "deviceMac": DEVICE_MAC_ADDR,
        "battery": 80,
        "detectionState": "DETECTED",
        "press": true,
        "timeOfSample": 123456789
    }
}

【Context No.43】
{
    "statusCode": 100,
    "body": {},
    "message": ""
}

【Context No.44】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoLock",
        "deviceMac": DEVICE_MAC_ADDR,
        "lockState": "LOCKED",
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.45】
{
    "statusCode": 100,
    "body": {
        "deviceId": "E2F6032048AB",
        "deviceType": "Curtain",
        "hubDeviceId": "FA7310762361",
        "calibrate": true,
        "group": false,
        "moving": false,
        "slidePosition": 0
    },
    "message": "success"
}

【Context No.46】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Humidifier2",
        "deviceMac": DEVICE_MAC_ADDR,
        "power": "on",
        "mode": 1,
        "drying": false,
        "timeOfSample": 123456789
    }
}

【Context No.47】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Smart Lock Ultra",
        "deviceMac": DEVICE_MAC_ADDR,
        "lockState": "LOCKED",
        "battery": 90,
        "timeOfSample": 123456789
    }
}

【Context No.48】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoLockLite",
        "deviceMac": DEVICE_MAC_ADDR,
        "lockState": "LOCKED",
        "battery": 90,
        "timeOfSample": 123456789
    }
}

【Context No.49】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "Air Purifier PM2.5",
        "deviceMac": DEVICE_MAC_ADDR,
        "power": "ON",
        "mode": 4,
        "childLock": 0,
        "timeOfSample": 123456789
    }
}

【Context No.50】
{
    "eventType": "changeReport",
    "eventVersion": "1",
    "context": {
        "deviceType": "WoLockPro",
        "deviceMac": DEVICE_MAC_ADDR,
        "lockState": "LOCKED",
        "battery":100,
        "timeOfSample": 123456789
    }
}

【Context No.51】
{
    "command": "ボタン", // the name of the customized button
    "parameter": "default",
    "commandType": "customize"
}

【Context No.52】
{
    "statusCode": 100,
    "body": {
        "deviceId": "C271111EC0AB",
        "deviceType": "Meter",
        "hubDeviceId": "FA7310762361",
        "humidity": 52,
        "temperature": 26.1
    },
    "message": "success"
}

【Context No.53】
{
    "statusCode": 100,
    "body": {},
    "message": "success"
}
```

## Output Indicator
Ensure that, except for the parts modified to follow the latest specifications, the structure and format of the code remain identical to the original code. Here, "identical" means that there should be no differences (diff) whatsoever, including in indentation, spaces, line breaks, and code structure, which should all be exactly the same as the original.
If there are any changes beyond the modified sections, this is considered incorrect.
Also, verify that the modified code conforms to the latest specifications.